# Notebooks

–í —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ä–∞–±–æ—á–∏–µ –Ω–æ—É—Ç–±—É–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç—Ä–∞–∂–∞—é—Ç —Ç–µ–∫—É—â–∏–π ML-–ø–∞–π–ø–ª–∞–π–Ω –ø—Ä–æ–µ–∫—Ç–∞.

–°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–¥–≤–∞** –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–æ—É—Ç–±—É–∫–∞:

- `01_comprehensive_eda_and_validation.ipynb`
- `02_model_training.ipynb`

---

## üìä 01_comprehensive_eda_and_validation.ipynb

–û–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –Ω–æ—É—Ç–±—É–∫ –¥–ª—è **EDA** –∏ –±–∞–∑–æ–≤–æ–π **–≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–∏—á–µ–π/—Å–ø–ª–∏—Ç–æ–≤**.

### –û—Å–Ω–æ–≤–Ω—ã–µ –±–ª–æ–∫–∏

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
   - `data/raw/train.csv`, `data/raw/test.csv`, `data/raw/sample_submission.csv`
   - –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã –∏ —Ç–∏–ø–æ–≤

2. **–ë—ã—Å—Ç—Ä—ã–π EDA –Ω–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   - –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∞—Ç–∞—Å–µ—Ç–∞, –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ö–≤–∞—Ç
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `sales`, –Ω—É–ª–µ–≤—ã–µ –ø—Ä–æ–¥–∞–∂–∏, –≤—ã–±—Ä–æ—Å—ã
   - –†–∞–∑–±–∏–≤–∫–∞ –ø–æ `store` –∏ `item`

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**
   - –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –¥–∞—Ç
   - –ì—Ä–∞–Ω–∏—Ü—ã train / (–±—É–¥—É—â–µ–≥–æ) test-–ø–µ—Ä–∏–æ–¥–∞

4. **–ê–Ω–∞–ª–∏–∑ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∏—á–µ–π (–Ω–∞ –æ—Å–Ω–æ–≤–µ processed-—Ñ–∞–π–ª–æ–≤)**
   - –ó–∞–≥—Ä—É–∑–∫–∞ `data/processed/train_features*.csv` (–µ—Å–ª–∏ —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ —Ñ–∏—á–∞—Ö
   - –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π

5. **–í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
   - –ö–∞–∫–∏–µ —Ñ–∏—á–∏ –≤—ã–≥–ª—è–¥—è—Ç –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–æ
   - –ö–∞–∫–∏–µ —Ñ–∏—á–∏/–ø–æ–¥—Ö–æ–¥—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ data leakage
   - –ö–∞–∫–∏–µ —Å–ø–ª–∏—Ç—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è/–≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
jupyter notebook notebooks/01_comprehensive_eda_and_validation.ipynb
```

---

## ü§ñ 02_model_training.ipynb

–ù–æ—É—Ç–±—É–∫ –¥–ª—è **–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π** –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –±–ª–æ–∫–∏

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏—á–µ–π**
   - `data/processed/train_features_cleaned.csv`
   - –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∏—á–µ–π —á–µ—Ä–µ–∑ `src/features/build_features.py` (–µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–ª—Å—è –Ω–µ —Ä–∞–Ω–µ–µ)

2. **–°–ø–ª–∏—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏**
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train / validation / (–ª–æ–∫–∞–ª—å–Ω—ã–π test) –ø–æ –¥–∞—Ç–∞–º
   - –£—á–µ—Ç —Ç–æ–≥–æ, —á—Ç–æ —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã (–Ω–∏–∫–∞–∫–æ–≥–æ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è)

3. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**
   - –û–±—É—á–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ LightGBM (–æ–¥–Ω–∞ –º–æ–¥–µ–ª—å –Ω–∞ –≤—Å–µ `store√óitem`)
   - –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—Ç—ã–º–∏ baseline'–∞–º–∏

4. **–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞**
   - –†–∞—Å—á—ë—Ç SMAPE –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ (MAE, RMSE –∏ –¥—Ä.) —á–µ—Ä–µ–∑ `src/models/metrics.py`
   - –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ `store`/`item`

5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤**
   - –ú–æ–¥–µ–ª—å: `artifacts/models/lightgbm_smape_11.74.joblib`
   - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: `artifacts/models/lightgbm_smape_11.74.json` (–≤–∫–ª—é—á–∞—è —Å–ø–∏—Å–æ–∫ feature_names)

### –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
jupyter notebook notebooks/02_model_training.ipynb
```

---

## üß© –°–≤—è–∑—å —Å –æ—Å—Ç–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π

- –ù–æ—É—Ç–±—É–∫–∏ **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø—Ä–æ–¥–µ –Ω–∞–ø—Ä—è–º—É—é**, –Ω–æ:
  - –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –¥–∏–∑–∞–π–Ω —Ñ–∏—á–µ–π –∏ –æ–±—É—á–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏;
  - –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫–∏–µ —Ñ–∏—á–∏ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ `data/processed/` –∏ `artifacts/models/`;
  - –∑–∞–¥–∞—é—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –∫–æ–¥–∞ –≤ `src/` (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è `src/features`, `src/models`, `src/app`).

- –ü—Ä–æ–¥–∞–∫—à–µ–Ω-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤:
  - `src/app/predictor.py` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ lookup –ø–æ `test_features_cleaned.csv`;
  - `src/app/main.py` ‚Äî FastAPI `/predict` –∏ `/health`;
  - `streamlit_app.py` + `ui/` ‚Äî UI-–æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ API.

